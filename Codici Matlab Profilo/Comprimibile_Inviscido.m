clear all; close all; clc;

%Calcolo del mach critico inferiore non viscoso.
%Plot dell'abaco GENERICO (non del profilo)
%Mach critico inferiore pag. 186 libro.

g = 1.4;                                                                %gamma
m = linspace(0,1,500);                                                  %mach
cp = linspace(-40,0,200);                                               %cp
k = (g - 1)/2; h = (g + 1)/2; t = sqrt(1 - m.^2);                       %valori notevoli

fdx = (2./(g.*m.^2)).*(((1 + k*m.^2)./((h')).^(g/(2*k)) - 1));          %funzione a destra

for i = 1:length(cp)                                                    %funzione a sinistra
    fsx(i,:) = cp(i)./(t + cp(i)/2.*((m.^2)./(1 + t)));
end

figure(1);                                                                 %plot della funzione a destra (unica)
plot(m,fdx,'r','LineWidth',1.1); hold on;
set(gca,'FontName','Cambria','FontSize',11,'FontAngle','normal');

for i = 1:length(cp)                                                    %pulizia fascio di curve (venivano sporche, alcuni valori non hanno senso)
    for j = 1:length(m)
        if fsx(i,j) > 0 %&& fsx(i,j) ~= 2
            fsx(i,j) = NaN;
        end
        if j == length(m) - 1 && i == length(cp) - 1
            fsx(i,j) = -120;
        end
    end
end

for i = 1:length(cp)                                                    %plot della funzione a sinistra (fascio di curve)
    plot(m,fsx(i,:),'k');
end
axis([0 1 -16 0]); axis ij; hold off;
xlabel('M_\infty','FontName','Cambria','FontSize',12,'FontAngle','italic');
ylabel('Cp_m_i_n','FontName','Cambria','FontSize',12,'FontAngle','italic');

%Terminato il plot dell'abaco generico, calcoliamo per valori del Cl
%variabili tra -1 e 1.4 con passo di 0.1 i valori del mach critico
%inferiore.

%         alpha    CL        CD       CDp       CM      Cpmin   XCpmin   Top_Xtr  Bot_Xtr
%         ------  --------  --------- --------- ------ -------- -------
 M = [   -13.554  -1.0000   0.00000  -0.00065  -0.1183 -33.6533   0.0013   0.0000   0.0000
         -12.692  -0.9000   0.00000  -0.00062  -0.1192 -30.0217   0.0013   0.0000   0.0000
         -11.831  -0.8000   0.00000  -0.00059  -0.1201 -26.5843   0.0013   0.0000   0.0000
         -10.971  -0.7000   0.00000  -0.00055  -0.1210 -23.3425   0.0013   0.0000   0.0000
         -10.113  -0.6000   0.00000  -0.00051  -0.1219 -20.2974   0.0013   0.0000   0.0000
          -9.256  -0.5000   0.00000  -0.00048  -0.1228 -17.4503   0.0013   0.0000   0.0000
          -8.400  -0.4000   0.00000  -0.00044  -0.1237 -14.8025   0.0013   0.0000   0.0000
          -7.545  -0.3000   0.00000  -0.00041  -0.1245 -12.3551   0.0013   0.0000   0.0000
          -6.690  -0.2000   0.00000  -0.00037  -0.1254 -10.1094   0.0013   0.0000   0.0000
          -5.835  -0.1000   0.00000  -0.00034  -0.1263  -8.0665   0.0013   0.0000   0.0000
          -4.981   0.0000   0.00000  -0.00031  -0.1272  -6.2276   0.0013   0.0000   0.0000
          -4.126   0.1000   0.00000  -0.00027  -0.1280  -4.5940   0.0013   0.0000   0.0000
          -3.272   0.2000   0.00000  -0.00025  -0.1289  -3.3103   0.0025   0.0000   0.0000
          -2.417   0.3000   0.00000  -0.00022  -0.1298  -2.2074   0.0025   0.0000   0.0000
          -1.561   0.4000   0.00000  -0.00020  -0.1306  -1.2654   0.0025   0.0000   0.0000
          -0.704   0.5000   0.00000  -0.00017  -0.1315  -0.5622   0.0290   0.0000   0.0000
           0.153   0.6000   0.00000  -0.00016  -0.1323  -0.8126   0.0290   0.0000   0.0000
           1.012   0.7000   0.00000  -0.00014  -0.1332  -1.0812   0.0290   0.0000   0.0000
           1.873   0.8000   0.00000  -0.00013  -0.1340  -1.3808   0.0228   0.0000   0.0000
           2.734   0.9000   0.00000  -0.00013  -0.1348  -1.8361   0.0070   0.0000   0.0000
           3.598   1.0000   0.00000  -0.00012  -0.1356  -2.4165   0.0070   0.0000   0.0000
           4.464   1.1000   0.00000  -0.00012  -0.1364  -3.1112   0.0050   0.0000   0.0000
           5.332   1.2000   0.00000  -0.00013  -0.1372  -3.8787   0.0050   0.0000   0.0000
           6.202   1.3000   0.00000  -0.00014  -0.1380  -4.7117   0.0050   0.0000   0.0000
           7.075   1.4000   0.00000  -0.00016  -0.1387  -5.8716  -0.0001   0.0000   0.0000 ];

cpmin = M(:,6);
%k = (g - 1)/2; h = (g + 1)/2; t = sqrt(1 - m.^2);                       %valori notevoli

for i = 1:length(cpmin)                                                 %funzione a sinistra per la sequenza di Cl in questione
    fsxmin(i,:) = cpmin(i)./(t + cpmin(i)/2.*((m.^2)./(1 + t)));
end

for i = 1:length(cpmin)                                                 %pulizia fascio di curve (discorso precedente, uguale)
    for j = 1:length(m)
        if fsxmin(i,j) > 0 %&& fsx(i,j) ~= 2
            fsxmin(i,j) = NaN;
        end
    end
end
%PLOT ABACO DEL PROFILO!
figure(2);                                                                 %plot della funzione a destra (unica)
plot(m,fdx,'k','LineWidth',1.1); hold on;
set(gca,'FontName','Cambria','FontSize',11,'FontAngle','normal');
for i = 1:length(cpmin)                                                    %plot della funzione a sinistra (fascio di curve)
    plot(m,fsxmin(i,:),'k');
end
axis([0 1 -16 0]); axis ij; hold off;
xlabel('M_\infty','FontName','Cambria','FontSize',12,'FontAngle','italic');
ylabel('Cp_m_i_n','FontName','Cambria','FontSize',12,'FontAngle','italic');





%RICERCA MACH CRITICO INFERIORE
for i = 1:length(cpmin)                                                 %valuto la differenza tra le curve a dx (sempre uguale) e quelle a sx (variano
    FX(i,:) = abs(fsxmin(i,:) - fdx);                                   %al variare del cp, quindi col variare del valore cpmin) e lo memorizzo 
end                                                                     %nella matrice FX
%prima cerco il minimo di ogni riga; poi memorizzo l'indice della colonna
%dove si trova tale minimo
%nella pratica sto trovando l'intersezione tra le due curve
for i = 1:length(cpmin)                                                 %controllo l'indice per cui su ognuna delle righe compare il corrispettivo
    mFX(i) = min(FX(i,:));                                              %valore minimo, memorizzandolo nel vettore index.
    for j = 1:length(m)
        if mFX(i) == FX(i,j)
            index(i) = j;
        end
    end
end
%trovato il punto di cui conosco l'indice prendo il rispettivo mach che è
%proprio il mach critico inferiore

for i = 1:length(cpmin)                                                 %calcolo qui il mach critico inferiore per ogni Cl
    mcrit(i) = m(index(i))
end

cseq = M(:,2);

figure(3);                                                                 %plot mach critico inferiore
plot(mcrit,cseq,'k-o');
set(gca,'FontName','Cambria','FontSize',11,'FontAngle','normal');
axis([0 1 -1 1.4]); grid on; set(gca,'YTick',-1:0.4:1.4);
xlabel('M_\infty _c_r_i_t _i_n_f','FontName','Cambria','FontSize',12,'FontAngle','italic');
ylabel('Cl','FontName','Cambria','FontSize',12,'FontAngle','italic');

%Confronto delle curve del cp per tre valori differenti del mach di volo,
%pari rispettivamente a M = 0, M = 0.3 e M = 0.4 per lo stesso valore del
%Cl = 0.5.

CP0 = [1.00000 -0.00435  0.35437                                        %mach 0, cl 0.5
   0.99614 -0.00289  0.08249
   0.98917 -0.00048 -0.06380
   0.98107  0.00199 -0.16199
   0.97222  0.00429 -0.20114
   0.96255  0.00641 -0.18565
   0.95203  0.00849 -0.15277
   0.94094  0.01067 -0.15610
   0.92971  0.01289 -0.18241
   0.91853  0.01502 -0.19829
   0.90725  0.01709 -0.20336
   0.89585  0.01914 -0.21167
   0.88443  0.02116 -0.22491
   0.87304  0.02314 -0.23709
   0.86160  0.02507 -0.24303
   0.85008  0.02699 -0.25185
   0.83858  0.02889 -0.26879
   0.82718  0.03075 -0.28907
   0.81587  0.03253 -0.30346
   0.80459  0.03423 -0.31395
   0.79325  0.03586 -0.31369
   0.78178  0.03745 -0.30750
   0.77029  0.03906 -0.31655
   0.75879  0.04069 -0.34057
   0.74745  0.04224 -0.36110
   0.73608  0.04372 -0.36457
   0.72461  0.04515 -0.36949
   0.71312  0.04656 -0.38301
   0.70172  0.04790 -0.39754
   0.69032  0.04918 -0.40300
   0.67884  0.05040 -0.40507
   0.66732  0.05160 -0.41724
   0.65592  0.05274 -0.43489
   0.64462  0.05379 -0.44591
   0.63328  0.05474 -0.44396
   0.62185  0.05564 -0.44549
   0.61040  0.05649 -0.44821
   0.59895  0.05727 -0.45142
   0.58752  0.05799 -0.45584
   0.57609  0.05864 -0.45497
   0.56463  0.05923 -0.45089
   0.55307  0.05976 -0.44470
   0.54144  0.06027 -0.44380
   0.52984  0.06076 -0.44860
   0.51829  0.06120 -0.45396
   0.50678  0.06160 -0.45786
   0.49530  0.06193 -0.46106
   0.48381  0.06220 -0.45935
   0.47230  0.06242 -0.45694
   0.46075  0.06258 -0.45401
   0.44917  0.06271 -0.45252
   0.43759  0.06279 -0.45111
   0.42600  0.06284 -0.45083
   0.41442  0.06285 -0.45153
   0.40284  0.06282 -0.45204
   0.39128  0.06274 -0.45310
   0.37972  0.06262 -0.45366
   0.36817  0.06246 -0.45534
   0.35664  0.06225 -0.45476
   0.34511  0.06198 -0.45442
   0.33357  0.06167 -0.45274
   0.32203  0.06131 -0.45120
   0.31047  0.06090 -0.44927
   0.29890  0.06046 -0.44784
   0.28733  0.05997 -0.44907
   0.27577  0.05944 -0.44996
   0.26424  0.05887 -0.45190
   0.25272  0.05825 -0.45387
   0.24123  0.05759 -0.45720
   0.22976  0.05686 -0.45953
   0.21832  0.05609 -0.46264
   0.20691  0.05524 -0.46487
   0.19553  0.05434 -0.46822
   0.18419  0.05335 -0.46988
   0.17287  0.05229 -0.47117
   0.16157  0.05115 -0.46962
   0.15025  0.04993 -0.46936
   0.13898  0.04864 -0.47577
   0.12783  0.04726 -0.48239
   0.11678  0.04579 -0.48959
   0.10584  0.04421 -0.49415
   0.09500  0.04249 -0.49627
   0.08426  0.04063 -0.49718
   0.07367  0.03864 -0.50581
   0.06349  0.03655 -0.53025
   0.05387  0.03430 -0.54873
   0.04480  0.03185 -0.53678
   0.03635  0.02923 -0.52718
   0.02903  0.02661 -0.56219
   0.02285  0.02388 -0.49402
   0.01754  0.02101 -0.32693
   0.01311  0.01830 -0.18914
   0.00962  0.01594 -0.13483
   0.00697  0.01384 -0.05386
   0.00495  0.01185  0.11493
   0.00343  0.00993  0.35110
   0.00226  0.00813  0.55481
   0.00132  0.00648  0.70198
   0.00062  0.00496  0.83045
   0.00014  0.00354  0.93955
  -0.00011  0.00220  0.99815
  -0.00014  0.00094  0.96348
   0.00008 -0.00031  0.79370
   0.00055 -0.00153  0.45623
   0.00134 -0.00265 -0.13624
   0.00251 -0.00348 -0.48523
   0.00405 -0.00392 -0.05102
   0.00587 -0.00428  0.18853
   0.00800 -0.00480  0.16225
   0.01055 -0.00550  0.05874
   0.01369 -0.00626 -0.05455
   0.01769 -0.00693 -0.03121
   0.02304 -0.00751  0.05550
   0.03018 -0.00824  0.07610
   0.03903 -0.00914  0.03573
   0.04921 -0.00994  0.06122
   0.06039 -0.01077  0.05798
   0.07168 -0.01158  0.04034
   0.08295 -0.01229  0.03366
   0.09436 -0.01291  0.03646
   0.10593 -0.01350  0.03463
   0.11753 -0.01406  0.02925
   0.12909 -0.01458  0.02145
   0.14059 -0.01506  0.01431
   0.15203 -0.01547  0.01030
   0.16354 -0.01581  0.01412
   0.17517 -0.01610  0.01782
   0.18687 -0.01639  0.01699
   0.19855 -0.01667  0.01328
   0.21019 -0.01692  0.01009
   0.22181 -0.01713  0.00747
   0.23340 -0.01731  0.00477
   0.24497 -0.01745  0.00346
   0.25654 -0.01755  0.00386
   0.26814 -0.01760  0.00742
   0.27978 -0.01762  0.00993
   0.29147 -0.01761  0.01383
   0.30320 -0.01759  0.01559
   0.31493 -0.01757  0.01574
   0.32664 -0.01753  0.01549
   0.33833 -0.01748  0.01491
   0.35001 -0.01740  0.01379
   0.36167 -0.01730  0.01498
   0.37334 -0.01717  0.01523
   0.38500 -0.01702  0.01634
   0.39667 -0.01685  0.01818
   0.40835 -0.01666  0.01890
   0.42003 -0.01644  0.02045
   0.43171 -0.01621  0.02105
   0.44340 -0.01595  0.02261
   0.45508 -0.01568  0.02299
   0.46675 -0.01538  0.02351
   0.47840 -0.01507  0.02322
   0.49003 -0.01472  0.02307
   0.50163 -0.01434  0.02251
   0.51318 -0.01393  0.02151
   0.52465 -0.01348  0.02076
   0.53606 -0.01295  0.02278
   0.54740 -0.01235  0.02801
   0.55879 -0.01166  0.04373
   0.57032 -0.01090  0.06294
   0.58187 -0.01017  0.07000
   0.59336 -0.00945  0.06630
   0.60473 -0.00866  0.07374
   0.61621 -0.00779  0.09349
   0.62779 -0.00689  0.11167
   0.63943 -0.00600  0.11981
   0.65111 -0.00511  0.12955
   0.66277 -0.00422  0.14278
   0.67435 -0.00335  0.15532
   0.68593 -0.00252  0.15875
   0.69747 -0.00169  0.16229
   0.70898 -0.00081  0.18031
   0.72044  0.00007  0.20177
   0.73179  0.00086  0.21062
   0.74327  0.00158  0.20957
   0.75481  0.00231  0.21741
   0.76632  0.00306  0.23650
   0.77772  0.00376  0.25177
   0.78915  0.00436  0.25696
   0.80071  0.00493  0.26388
   0.81220  0.00548  0.28184
   0.82345  0.00594  0.29852
   0.83455  0.00628  0.30825
   0.84564  0.00646  0.31329
   0.85680  0.00652  0.31441
   0.86811  0.00647  0.31205
   0.87949  0.00635  0.31927
   0.89068  0.00616  0.33114
   0.90158  0.00584  0.34112
   0.91237  0.00533  0.34220
   0.92314  0.00464  0.33844
   0.93392  0.00377  0.33374
   0.94467  0.00271  0.32349
   0.95547  0.00146  0.30386
   0.96649  0.00003  0.27237
   0.97747 -0.00144  0.24599
   0.98756 -0.00276  0.23877
   0.99578 -0.00381  0.25551
   1.00000 -0.00435  0.35437];

CP03 = [1.00000 -0.00435  0.36798                                       %mach 0.3, cl 0.5
   0.99614 -0.00289  0.08607
   0.98917 -0.00048 -0.06671
   0.98107  0.00199 -0.17001
   0.97222  0.00429 -0.21085
   0.96255  0.00641 -0.19420
   0.95203  0.00849 -0.15939
   0.94094  0.01067 -0.16253
   0.92971  0.01289 -0.19012
   0.91853  0.01502 -0.20655
   0.90725  0.01709 -0.21179
   0.89585  0.01914 -0.22036
   0.88443  0.02116 -0.23417
   0.87304  0.02314 -0.24682
   0.86160  0.02507 -0.25291
   0.85008  0.02699 -0.26208
   0.83858  0.02889 -0.27979
   0.82718  0.03075 -0.30110
   0.81587  0.03253 -0.31614
   0.80459  0.03423 -0.32717
   0.79325  0.03586 -0.32656
   0.78178  0.03745 -0.31987
   0.77029  0.03906 -0.32930
   0.75879  0.04069 -0.35456
   0.74745  0.04224 -0.37615
   0.73608  0.04372 -0.37975
   0.72461  0.04515 -0.38467
   0.71312  0.04656 -0.39890
   0.70172  0.04790 -0.41408
   0.69032  0.04918 -0.41976
   0.67884  0.05040 -0.42171
   0.66732  0.05160 -0.43451
   0.65592  0.05274 -0.45298
   0.64462  0.05379 -0.46461
   0.63328  0.05474 -0.46224
   0.62185  0.05564 -0.46369
   0.61040  0.05649 -0.46634
   0.59895  0.05727 -0.46950
   0.58752  0.05799 -0.47403
   0.57609  0.05864 -0.47281
   0.56463  0.05923 -0.46828
   0.55307  0.05976 -0.46142
   0.54144  0.06027 -0.46021
   0.52984  0.06076 -0.46508
   0.51829  0.06120 -0.47054
   0.50678  0.06160 -0.47439
   0.49530  0.06193 -0.47757
   0.48381  0.06220 -0.47546
   0.47230  0.06242 -0.47258
   0.46075  0.06258 -0.46922
   0.44917  0.06271 -0.46733
   0.43759  0.06279 -0.46555
   0.42600  0.06284 -0.46489
   0.41442  0.06285 -0.46536
   0.40284  0.06282 -0.46556
   0.39128  0.06274 -0.46633
   0.37972  0.06262 -0.46660
   0.36817  0.06246 -0.46802
   0.35664  0.06225 -0.46700
   0.34511  0.06198 -0.46627
   0.33357  0.06167 -0.46408
   0.32203  0.06131 -0.46200
   0.31047  0.06090 -0.45953
   0.29890  0.06046 -0.45753
   0.28733  0.05997 -0.45840
   0.27577  0.05944 -0.45882
   0.26424  0.05887 -0.46031
   0.25272  0.05825 -0.46184
   0.24123  0.05759 -0.46477
   0.22976  0.05686 -0.46659
   0.21832  0.05609 -0.46919
   0.20691  0.05524 -0.47084
   0.19553  0.05434 -0.47357
   0.18419  0.05335 -0.47449
   0.17287  0.05229 -0.47491
   0.16157  0.05115 -0.47230
   0.15025  0.04993 -0.47093
   0.13898  0.04864 -0.47647
   0.12783  0.04726 -0.48208
   0.11678  0.04579 -0.48812
   0.10584  0.04421 -0.49120
   0.09500  0.04249 -0.49144
   0.08426  0.04063 -0.49011
   0.07367  0.03864 -0.49642
   0.06349  0.03655 -0.51872
   0.05387  0.03430 -0.53408
   0.04480  0.03185 -0.51685
   0.03635  0.02923 -0.50103
   0.02903  0.02661 -0.52998
   0.02285  0.02388 -0.45128
   0.01754  0.02101 -0.27192
   0.01311  0.01830 -0.12355
   0.00962  0.01594 -0.05814
   0.00697  0.01384  0.03446
   0.00495  0.01185  0.21085
   0.00343  0.00993  0.44525
   0.00226  0.00813  0.64221
   0.00132  0.00648  0.78305
   0.00062  0.00496  0.90140
   0.00014  0.00354  0.99227
  -0.00011  0.00220  1.02256
  -0.00014  0.00094  0.95033
   0.00008 -0.00031  0.73467
   0.00055 -0.00153  0.33960
   0.00134 -0.00265 -0.34441
   0.00251 -0.00348 -0.71852
   0.00405 -0.00392 -0.17042
   0.00587 -0.00428  0.11822
   0.00800 -0.00480  0.09712
   0.01055 -0.00550 -0.01119
   0.01369 -0.00626 -0.12969
   0.01769 -0.00693 -0.09519
   0.02304 -0.00751  0.00788
   0.03018 -0.00824  0.03640
   0.03903 -0.00914 -0.00244
   0.04921 -0.00994  0.02958
   0.06039 -0.01077  0.02947
   0.07168 -0.01158  0.01312
   0.08295 -0.01229  0.00812
   0.09436 -0.01291  0.01294
   0.10593 -0.01350  0.01255
   0.11753 -0.01406  0.00811
   0.12909 -0.01458  0.00094
   0.14059 -0.01506 -0.00565
   0.15203 -0.01547 -0.00901
   0.16354 -0.01581 -0.00410
   0.17517 -0.01610  0.00064
   0.18687 -0.01639  0.00043
   0.19855 -0.01667 -0.00286
   0.21019 -0.01692 -0.00568
   0.22181 -0.01713 -0.00792
   0.23340 -0.01731 -0.01025
   0.24497 -0.01745 -0.01121
   0.25654 -0.01755 -0.01027
   0.26814 -0.01760 -0.00611
   0.27978 -0.01762 -0.00302
   0.29147 -0.01761  0.00150
   0.30320 -0.01759  0.00372
   0.31493 -0.01757  0.00422
   0.32664 -0.01753  0.00428
   0.33833 -0.01748  0.00400
   0.35001 -0.01740  0.00311
   0.36167 -0.01730  0.00466
   0.37334 -0.01717  0.00515
   0.38500 -0.01702  0.00667
   0.39667 -0.01685  0.00882
   0.40835 -0.01666  0.00982
   0.42003 -0.01644  0.01174
   0.43171 -0.01621  0.01256
   0.44340 -0.01595  0.01446
   0.45508 -0.01568  0.01506
   0.46675 -0.01538  0.01584
   0.47840 -0.01507  0.01571
   0.49003 -0.01472  0.01578
   0.50163 -0.01434  0.01536
   0.51318 -0.01393  0.01452
   0.52465 -0.01348  0.01388
   0.53606 -0.01295  0.01624
   0.54740 -0.01235  0.02194
   0.55879 -0.01166  0.03863
   0.57032 -0.01090  0.05898
   0.58187 -0.01017  0.06665
   0.59336 -0.00945  0.06292
   0.60473 -0.00866  0.07090
   0.61621 -0.00779  0.09175
   0.62779 -0.00689  0.11105
   0.63943 -0.00600  0.11968
   0.65111 -0.00511  0.13000
   0.66277 -0.00422  0.14404
   0.67435 -0.00335  0.15728
   0.68593 -0.00252  0.16097
   0.69747 -0.00169  0.16481
   0.70898 -0.00081  0.18380
   0.72044  0.00007  0.20626
   0.73179  0.00086  0.21564
   0.74327  0.00158  0.21463
   0.75481  0.00231  0.22294
   0.76632  0.00306  0.24295
   0.77772  0.00376  0.25890
   0.78915  0.00436  0.26442
   0.80071  0.00493  0.27172
   0.81220  0.00548  0.29046
   0.82345  0.00594  0.30793
   0.83455  0.00628  0.31799
   0.84564  0.00646  0.32339
   0.85680  0.00652  0.32468
   0.86811  0.00647  0.32225
   0.87949  0.00635  0.32989
   0.89068  0.00616  0.34223
   0.90158  0.00584  0.35267
   0.91237  0.00533  0.35393
   0.92314  0.00464  0.35010
   0.93392  0.00377  0.34535
   0.94467  0.00271  0.33485
   0.95547  0.00146  0.31465
   0.96649  0.00003  0.28226
   0.97747 -0.00144  0.25502
   0.98756 -0.00276  0.24769
   0.99578 -0.00381  0.26521
   1.00000 -0.00435  0.36798];

CP04 = [1.00000 -0.00435  0.37987                                       %mach 0.4, cl 0.5
   0.99614 -0.00289  0.08926
   0.98917 -0.00048 -0.06926
   0.98107  0.00199 -0.17714
   0.97222  0.00429 -0.21950
   0.96255  0.00641 -0.20182
   0.95203  0.00849 -0.16528
   0.94094  0.01067 -0.16824
   0.92971  0.01289 -0.19699
   0.91853  0.01502 -0.21391
   0.90725  0.01709 -0.21931
   0.89585  0.01914 -0.22810
   0.88443  0.02116 -0.24243
   0.87304  0.02314 -0.25550
   0.86160  0.02507 -0.26172
   0.85008  0.02699 -0.27122
   0.83858  0.02889 -0.28961
   0.82718  0.03075 -0.31185
   0.81587  0.03253 -0.32748
   0.80459  0.03423 -0.33901
   0.79325  0.03586 -0.33807
   0.78178  0.03745 -0.33094
   0.77029  0.03906 -0.34071
   0.75879  0.04069 -0.36708
   0.74745  0.04224 -0.38963
   0.73608  0.04372 -0.39335
   0.72461  0.04515 -0.39827
   0.71312  0.04656 -0.41315
   0.70172  0.04790 -0.42892
   0.69032  0.04918 -0.43479
   0.67884  0.05040 -0.43663
   0.66732  0.05160 -0.45001
   0.65592  0.05274 -0.46923
   0.64462  0.05379 -0.48141
   0.63328  0.05474 -0.47865
   0.62185  0.05564 -0.48003
   0.61040  0.05649 -0.48263
   0.59895  0.05727 -0.48574
   0.58752  0.05799 -0.49036
   0.57609  0.05864 -0.48883
   0.56463  0.05923 -0.48389
   0.55307  0.05976 -0.47642
   0.54144  0.06027 -0.47493
   0.52984  0.06076 -0.47986
   0.51829  0.06120 -0.48541
   0.50678  0.06160 -0.48921
   0.49530  0.06193 -0.49237
   0.48381  0.06220 -0.48990
   0.47230  0.06242 -0.48659
   0.46075  0.06258 -0.48285
   0.44917  0.06271 -0.48059
   0.43759  0.06279 -0.47847
   0.42600  0.06284 -0.47746
   0.41442  0.06285 -0.47773
   0.40284  0.06282 -0.47765
   0.39128  0.06274 -0.47814
   0.37972  0.06262 -0.47815
   0.36817  0.06246 -0.47934
   0.35664  0.06225 -0.47791
   0.34511  0.06198 -0.47683
   0.33357  0.06167 -0.47418
   0.32203  0.06131 -0.47162
   0.31047  0.06090 -0.46866
   0.29890  0.06046 -0.46614
   0.28733  0.05997 -0.46668
   0.27577  0.05944 -0.46667
   0.26424  0.05887 -0.46776
   0.25272  0.05825 -0.46889
   0.24123  0.05759 -0.47146
   0.22976  0.05686 -0.47281
   0.21832  0.05609 -0.47494
   0.20691  0.05524 -0.47606
   0.19553  0.05434 -0.47824
   0.18419  0.05335 -0.47849
   0.17287  0.05229 -0.47813
   0.16157  0.05115 -0.47456
   0.15025  0.04993 -0.47217
   0.13898  0.04864 -0.47692
   0.12783  0.04726 -0.48162
   0.11678  0.04579 -0.48662
   0.10584  0.04421 -0.48835
   0.09500  0.04249 -0.48691
   0.08426  0.04063 -0.48355
   0.07367  0.03864 -0.48779
   0.06349  0.03655 -0.50814
   0.05387  0.03430 -0.52067
   0.04480  0.03185 -0.49876
   0.03635  0.02923 -0.47745
   0.02903  0.02661 -0.50095
   0.02285  0.02388 -0.41323
   0.01754  0.02101 -0.22384
   0.01311  0.01830 -0.06705
   0.00962  0.01594  0.00730
   0.00697  0.01384  0.10891
   0.00495  0.01185  0.29022
   0.00343  0.00993  0.52144
   0.00226  0.00813  0.71141
   0.00132  0.00648  0.84567
   0.00062  0.00496  0.95426
   0.00014  0.00354  1.02888
  -0.00011  0.00220  1.03507
  -0.00014  0.00094  0.93129
   0.00008 -0.00031  0.67637
   0.00055 -0.00153  0.22871
   0.00134 -0.00265 -0.54666
   0.00251 -0.00348 -0.94727
   0.00405 -0.00392 -0.28211
   0.00587 -0.00428  0.05413
   0.00800 -0.00480  0.03793
   0.01055 -0.00550 -0.07499
   0.01369 -0.00626 -0.19854
   0.01769 -0.00693 -0.15348
   0.02304 -0.00751 -0.03505
   0.03018 -0.00824  0.00078
   0.03903 -0.00914 -0.03669
   0.04921 -0.00994  0.00132
   0.06039 -0.01077  0.00404
   0.07168 -0.01158 -0.01115
   0.08295 -0.01229 -0.01463
   0.09436 -0.01291 -0.00799
   0.10593 -0.01350 -0.00709
   0.11753 -0.01406 -0.01067
   0.12909 -0.01458 -0.01729
   0.14059 -0.01506 -0.02340
   0.15203 -0.01547 -0.02618
   0.16354 -0.01581 -0.02027
   0.17517 -0.01610 -0.01461
   0.18687 -0.01639 -0.01425
   0.19855 -0.01667 -0.01718
   0.21019 -0.01692 -0.01966
   0.22181 -0.01713 -0.02156
   0.23340 -0.01731 -0.02356
   0.24497 -0.01745 -0.02422
   0.25654 -0.01755 -0.02279
   0.26814 -0.01760 -0.01809
   0.27978 -0.01762 -0.01448
   0.29147 -0.01761 -0.00940
   0.30320 -0.01759 -0.00677
   0.31493 -0.01757 -0.00595
   0.32664 -0.01753 -0.00563
   0.33833 -0.01748 -0.00563
   0.35001 -0.01740 -0.00632
   0.36167 -0.01730 -0.00446
   0.37334 -0.01717 -0.00375
   0.38500 -0.01702 -0.00187
   0.39667 -0.01685  0.00057
   0.40835 -0.01666  0.00182
   0.42003 -0.01644  0.00406
   0.43171 -0.01621  0.00508
   0.44340 -0.01595  0.00729
   0.45508 -0.01568  0.00808
   0.46675 -0.01538  0.00909
   0.47840 -0.01507  0.00910
   0.49003 -0.01472  0.00936
   0.50163 -0.01434  0.00907
   0.51318 -0.01393  0.00838
   0.52465 -0.01348  0.00783
   0.53606 -0.01295  0.01049
   0.54740 -0.01235  0.01660
   0.55879 -0.01166  0.03416
   0.57032 -0.01090  0.05554
   0.58187 -0.01017  0.06374
   0.59336 -0.00945  0.05999
   0.60473 -0.00866  0.06843
   0.61621 -0.00779  0.09027
   0.62779 -0.00689  0.11056
   0.63943 -0.00600  0.11963
   0.65111 -0.00511  0.13046
   0.66277 -0.00422  0.14521
   0.67435 -0.00335  0.15907
   0.68593 -0.00252  0.16298
   0.69747 -0.00169  0.16708
   0.70898 -0.00081  0.18694
   0.72044  0.00007  0.21027
   0.73179  0.00086  0.22010
   0.74327  0.00158  0.21914
   0.75481  0.00231  0.22786
   0.76632  0.00306  0.24867
   0.77772  0.00376  0.26522
   0.78915  0.00436  0.27101
   0.80071  0.00493  0.27864
   0.81220  0.00548  0.29806
   0.82345  0.00594  0.31623
   0.83455  0.00628  0.32657
   0.84564  0.00646  0.33228
   0.85680  0.00652  0.33372
   0.86811  0.00647  0.33122
   0.87949  0.00635  0.33923
   0.89068  0.00616  0.35198
   0.90158  0.00584  0.36281
   0.91237  0.00533  0.36421
   0.92314  0.00464  0.36033
   0.93392  0.00377  0.35553
   0.94467  0.00271  0.34482
   0.95547  0.00146  0.32412
   0.96649  0.00003  0.29096
   0.97747 -0.00144  0.26297
   0.98756 -0.00276  0.25556
   0.99578 -0.00381  0.27374
   1.00000 -0.00435  0.37987];

figure(3);
plot(CP0(:,1),CP0(:,3),'k-*','MarkerIndices',1:7:length(CP0(:,3)),'Markersize',5,'LineWidth',0.4); hold on;
plot(CP03(:,1),CP03(:,3),'k:s','MarkerIndices',1:7:length(CP0(:,3)),'Markersize',5,'LineWidth',0.4); hold on;
plot(CP04(:,1),CP04(:,3),'k--o','MarkerIndices',1:7:length(CP0(:,3)),'Markersize',5,'LineWidth',0.4); hold off;
set(gca,'FontName','Cambria','FontSize',11,'FontAngle','normal');
xlabel('x/c','FontName','Cambria','FontSize',12,'FontAngle','italic');
ylabel('Cp','FontName','Cambria','FontSize',12,'FontAngle','italic');
legend('M_\infty = 0','M_\infty = 0.3','M_\infty = 0.4');
axis([-0.2 1.2 -1.2 1.2]); axis ij; grid on;

%Confronto curve Cl-alfa al variare del Mach per gli stessi valori
%precedenti.

CLA0 = [-10.000  -0.5868   0.00000  -0.00051  -0.1220   0.0000   0.0000
  -9.000  -0.4701   0.00000  -0.00047  -0.1230   0.0000   0.0000
  -8.000  -0.3532   0.00000  -0.00043  -0.1241   0.0000   0.0000
  -7.000  -0.2363   0.00000  -0.00038  -0.1251   0.0000   0.0000
  -6.000  -0.1193   0.00000  -0.00034  -0.1261   0.0000   0.0000
  -5.000  -0.0022   0.00000  -0.00031  -0.1272   0.0000   0.0000
  -4.000   0.1148   0.00000  -0.00027  -0.1282   0.0000   0.0000
  -3.000   0.2318   0.00000  -0.00024  -0.1292   0.0000   0.0000
  -2.000   0.3487   0.00000  -0.00021  -0.1302   0.0000   0.0000
  -1.000   0.4655   0.00000  -0.00018  -0.1312   0.0000   0.0000
   0.000   0.5821   0.00000  -0.00016  -0.1322   0.0000   0.0000
   1.000   0.6986   0.00000  -0.00014  -0.1331   0.0000   0.0000
   2.000   0.8148   0.00000  -0.00013  -0.1341   0.0000   0.0000
   3.000   0.9308   0.00000  -0.00012  -0.1350   0.0000   0.0000
   4.000   1.0465   0.00000  -0.00012  -0.1360   0.0000   0.0000
   5.000   1.1618   0.00000  -0.00013  -0.1369   0.0000   0.0000
   6.000   1.2768   0.00000  -0.00014  -0.1378   0.0000   0.0000
   7.000   1.3914   0.00000  -0.00016  -0.1387   0.0000   0.0000
   8.000   1.5056   0.00000  -0.00019  -0.1395   0.0000   0.0000
   9.000   1.6193   0.00000  -0.00022  -0.1404   0.0000   0.0000
  10.000   1.7325   0.00000  -0.00026  -0.1412   0.0000   0.0000];

CLA03 = [-10.000  -0.6935   0.00000  -0.05072  -0.1434   0.0000   0.0000
  -9.000  -0.5430   0.00000  -0.03149  -0.1390   0.0000   0.0000
  -8.000  -0.4019   0.00000  -0.01916  -0.1364   0.0000   0.0000
  -7.000  -0.2669   0.00000  -0.01131  -0.1350   0.0000   0.0000
  -6.000  -0.1360   0.00000  -0.00643  -0.1345   0.0000   0.0000
  -5.000  -0.0079   0.00000  -0.00351  -0.1346   0.0000   0.0000
  -4.000   0.1183   0.00000  -0.00186  -0.1351   0.0000   0.0000
  -3.000   0.2433   0.00000  -0.00100  -0.1358   0.0000   0.0000
  -2.000   0.3675   0.00000  -0.00062  -0.1368   0.0000   0.0000
  -1.000   0.4912   0.00000  -0.00052  -0.1378   0.0000   0.0000
   0.000   0.6149   0.00000  -0.00062  -0.1388   0.0000   0.0000
   1.000   0.7387   0.00000  -0.00089  -0.1398   0.0000   0.0000
   2.000   0.8628   0.00000  -0.00142  -0.1406   0.0000   0.0000
   3.000   0.9876   0.00000  -0.00237  -0.1412   0.0000   0.0000
   4.000   1.1132   0.00000  -0.00400  -0.1417   0.0000   0.0000
   5.000   1.2400   0.00000  -0.00668  -0.1418   0.0000   0.0000
   6.000   1.3681   0.00000  -0.01094  -0.1417   0.0000   0.0000
   7.000   1.4981   0.00000  -0.01747  -0.1411   0.0000   0.0000
   8.000   1.6302   0.00000  -0.02726  -0.1402   0.0000   0.0000
   9.000   1.7651   0.00000  -0.04163  -0.1388   0.0000   0.0000
  10.000   1.9035   0.00000  -0.06246  -0.1370   0.0000   0.0000];

CLA04 = [-10.000  -1.0974   0.00000  -0.30334  -0.2283   0.0000   0.0000
  -9.000  -0.6865   0.00000  -0.11261  -0.1701   0.0000   0.0000
  -8.000  -0.4738   0.00000  -0.05509  -0.1535   0.0000   0.0000
  -7.000  -0.3055   0.00000  -0.02844  -0.1463   0.0000   0.0000
  -6.000  -0.1554   0.00000  -0.01467  -0.1429   0.0000   0.0000
  -5.000  -0.0146   0.00000  -0.00738  -0.1416   0.0000   0.0000
  -4.000   0.1210   0.00000  -0.00360  -0.1413   0.0000   0.0000
  -3.000   0.2535   0.00000  -0.00177  -0.1418   0.0000   0.0000
  -2.000   0.3843   0.00000  -0.00101  -0.1426   0.0000   0.0000
  -1.000   0.5144   0.00000  -0.00085  -0.1437   0.0000   0.0000
   0.000   0.6444   0.00000  -0.00106  -0.1447   0.0000   0.0000
   1.000   0.7749   0.00000  -0.00163  -0.1456   0.0000   0.0000
   2.000   0.9065   0.00000  -0.00272  -0.1463   0.0000   0.0000
   3.000   1.0396   0.00000  -0.00469  -0.1466   0.0000   0.0000
   4.000   1.1749   0.00000  -0.00811  -0.1465   0.0000   0.0000
   5.000   1.3131   0.00000  -0.01390  -0.1458   0.0000   0.0000
   6.000   1.4551   0.00000  -0.02340  -0.1443   0.0000   0.0000
   7.000   1.6021   0.00000  -0.03874  -0.1419   0.0000   0.0000
   8.000   1.7557   0.00000  -0.06331  -0.1385   0.0000   0.0000
   9.000   1.9184   0.00000  -0.10296  -0.1338   0.0000   0.0000
  10.000   2.0941   0.00000  -0.16880  -0.1276   0.0000   0.0000];

figure(4);
plot(CLA0(:,1),CLA0(:,2),'k-.*','MarkerIndices',1:2:length(CP0(:,3)),'Markersize',5,'LineWidth',0.4); hold on;
plot(CLA03(:,1),CLA03(:,2),'k-s','MarkerIndices',1:2:length(CP0(:,3)),'Markersize',5,'LineWidth',0.4); hold on;
plot(CLA04(:,1),CLA04(:,2),'k--o','MarkerIndices',1:2:length(CP0(:,3)),'Markersize',5,'LineWidth',0.4); hold off;
set(gca,'FontName','Cambria','FontSize',11,'FontAngle','normal','XTick',-10:2:10);
xlabel('\alpha','FontName','Cambria','FontSize',12,'FontAngle','italic');
ylabel('Cl','FontName','Cambria','FontSize',12,'FontAngle','italic');
legend('M_\infty = 0','M_\infty = 0.3','M_\infty = 0.4','Location','SouthEast');
axis([-7 5 -0.6 1.4]); grid on;

% % saveas(gcf,'c_Cl_alfa_mseq.png');
% % saveas(figure(1),'c_abaco.png');
% % saveas(figure(2),'c_mcritinf.png');
% % saveas(figure(3),'c_Cp_Cl05.png');